{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\r\nimport iziToast from \"izitoast\";\r\nimport \"izitoast/dist/css/iziToast.min.css\";\r\nimport \"flatpickr/dist/flatpickr.min.css\";\r\n\r\nconst dateTimePicker = document.querySelector(\"input#datetime-picker\");\r\nconst button = document.querySelector('button[data-start]');\r\nconst dataDays = document.querySelector('[data-days]');\r\nconst dataHours= document.querySelector('[data-hours]');\r\nconst dataMinutes = document.querySelector('[data-minutes]');\r\nconst dataSeconds = document.querySelector('[data-seconds]');\r\n\r\nlet userSelectedDate = null;\r\n\r\nbutton.addEventListener('click', handleStart);\r\n\r\nfunction disableElement(...elements) {\r\n    elements.forEach((element) => element.classList.add('disabled'));\r\n}\r\n\r\n\r\nfunction enableElement(...elements) {\r\n    elements.forEach((element) => element.classList.remove('disabled'));\r\n}\r\n\r\nfunction getTimestamp(date) {\r\n    const dateObj = new Date(date);\r\n    return dateObj.getTime();\r\n}\r\n\r\nfunction getTimestampDifference(timestamp) {\r\n    const currentTime = Date.now();\r\n    return timestamp - currentTime;\r\n}\r\n\r\nfunction checkPickedTimevalidity(timestamp) {\r\n    const currentTime = Date.now();\r\n    if(currentTime < timestamp){\r\n        return true\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction validatePickedTime(timestamp = getTimestamp(dateTimePicker.value)) {\r\n    if (!checkPickedTimevalidity(timestamp)) {\r\n        disableElement(button);\r\n        iziToast.warning({\r\n            message: \"Please choose a date in the future\",\r\n            position: \"topRight\"\r\n        });\r\n        return false\r\n    }\r\n    else {\r\n        enableElement(button);\r\n        return true\r\n    }\r\n}\r\n\r\n\r\n\r\nconst options = {\r\n  enableTime: true,\r\n  time_24hr: true,\r\n  defaultDate: new Date(),\r\n  minuteIncrement: 1,\r\n    onClose(selectedDates) {\r\n        const pickedDateTimestamp = getTimestamp(selectedDates[0])\r\n        validatePickedTime(pickedDateTimestamp)\r\n  },\r\n};\r\n\r\nfunction updateClockFace({ days, hours, minutes, seconds }) {\r\n    dataDays.textContent = days;\r\n    dataHours.textContent = hours;\r\n    dataMinutes.textContent = minutes;\r\n    dataSeconds.textContent = seconds;\r\n}\r\n\r\nclass Timer{\r\n    constructor({onTick, startTime}){\r\n        this.onTick = onTick;\r\n        this.startTime = startTime;\r\n        this.intervalId = null;\r\n        this.timerInitTime = null;\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.timerInitTime = getTimestampDifference(this.startTime);\r\n        this.onTick(this.convertMs(this.timerInitTime));\r\n    }\r\n\r\n    start() {\r\n        disableElement(dateTimePicker, button);\r\n        let elapsedTime = 0;\r\n        \r\n        this.intervalId = setInterval(() => {\r\n            elapsedTime += 1000;\r\n            if (elapsedTime <= this.timerInitTime) {\r\n                this.onTick(this.convertMs(this.timerInitTime - elapsedTime));\r\n            }\r\n            else {\r\n                clearInterval(this.intervalId)\r\n                enableElement(dateTimePicker)\r\n            }\r\n        },1000)\r\n    }\r\n\r\n    convertMs(ms) {\r\n        // Number of milliseconds per unit of time\r\n        const second = 1000;\r\n        const minute = second * 60;\r\n        const hour = minute * 60;\r\n        const day = hour * 24;\r\n\r\n        // Remaining days\r\n        const days = this.pad(Math.floor(ms / day));\r\n        // Remaining hours\r\n        const hours = this.pad(Math.floor((ms % day) / hour));\r\n        // Remaining minutes\r\n        const minutes = this.pad(Math.floor(((ms % day) % hour) / minute));\r\n        // Remaining seconds\r\n        const seconds = this.pad(Math.floor((((ms % day) % hour) % minute) / second));\r\n\r\n        return { days, hours, minutes, seconds };\r\n    };\r\n\r\n    pad(val) {\r\n        return String(val).padStart(2,\"0\");\r\n    };\r\n}\r\n\r\nfunction handleStart(event) {\r\n    if (validatePickedTime()) {\r\n        const timer = new Timer({ onTick: updateClockFace, startTime: getTimestamp(dateTimePicker.value) });    \r\n        timer.start();\r\n    }\r\n    \r\n    \r\n}\r\n\r\n\r\n\r\nflatpickr(dateTimePicker, options);\r\n"],"names":["dateTimePicker","button","dataDays","dataHours","dataMinutes","dataSeconds","handleStart","disableElement","elements","element","enableElement","getTimestamp","date","getTimestampDifference","timestamp","currentTime","checkPickedTimevalidity","validatePickedTime","iziToast","options","selectedDates","pickedDateTimestamp","updateClockFace","days","hours","minutes","seconds","Timer","onTick","startTime","elapsedTime","ms","val","event","flatpickr"],"mappings":"0IAKA,MAAMA,EAAiB,SAAS,cAAc,uBAAuB,EAC/DC,EAAS,SAAS,cAAc,oBAAoB,EACpDC,EAAW,SAAS,cAAc,aAAa,EAC/CC,EAAW,SAAS,cAAc,cAAc,EAChDC,EAAc,SAAS,cAAc,gBAAgB,EACrDC,EAAc,SAAS,cAAc,gBAAgB,EAI3DJ,EAAO,iBAAiB,QAASK,CAAW,EAE5C,SAASC,KAAkBC,EAAU,CACjCA,EAAS,QAASC,GAAYA,EAAQ,UAAU,IAAI,UAAU,CAAC,CACnE,CAGA,SAASC,KAAiBF,EAAU,CAChCA,EAAS,QAASC,GAAYA,EAAQ,UAAU,OAAO,UAAU,CAAC,CACtE,CAEA,SAASE,EAAaC,EAAM,CAExB,OADgB,IAAI,KAAKA,CAAI,EACd,SACnB,CAEA,SAASC,EAAuBC,EAAW,CACvC,MAAMC,EAAc,KAAK,MACzB,OAAOD,EAAYC,CACvB,CAEA,SAASC,EAAwBF,EAAW,CAExC,OADoB,KAAK,MACRA,CAIrB,CAEA,SAASG,EAAmBH,EAAYH,EAAaX,EAAe,KAAK,EAAG,CACxE,OAAKgB,EAAwBF,CAAS,GASlCJ,EAAcT,CAAM,EACb,KATPM,EAAeN,CAAM,EACrBiB,EAAS,QAAQ,CACb,QAAS,qCACT,SAAU,UACtB,CAAS,EACM,GAMf,CAIA,MAAMC,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACf,QAAQC,EAAe,CACnB,MAAMC,EAAsBV,EAAaS,EAAc,CAAC,CAAC,EACzDH,EAAmBI,CAAmB,CAC3C,CACH,EAEA,SAASC,EAAgB,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,EAAI,CACxDxB,EAAS,YAAcqB,EACvBpB,EAAU,YAAcqB,EACxBpB,EAAY,YAAcqB,EAC1BpB,EAAY,YAAcqB,CAC9B,CAEA,MAAMC,CAAK,CACP,YAAY,CAAC,OAAAC,EAAQ,UAAAC,CAAS,EAAE,CAC5B,KAAK,OAASD,EACd,KAAK,UAAYC,EACjB,KAAK,WAAa,KAClB,KAAK,cAAgB,KACrB,KAAK,KAAI,CACZ,CAED,MAAO,CACH,KAAK,cAAgBhB,EAAuB,KAAK,SAAS,EAC1D,KAAK,OAAO,KAAK,UAAU,KAAK,aAAa,CAAC,CACjD,CAED,OAAQ,CACJN,EAAeP,EAAgBC,CAAM,EACrC,IAAI6B,EAAc,EAElB,KAAK,WAAa,YAAY,IAAM,CAChCA,GAAe,IACXA,GAAe,KAAK,cACpB,KAAK,OAAO,KAAK,UAAU,KAAK,cAAgBA,CAAW,CAAC,GAG5D,cAAc,KAAK,UAAU,EAC7BpB,EAAcV,CAAc,EAEnC,EAAC,GAAI,CACT,CAED,UAAU+B,EAAI,CAQV,MAAMR,EAAO,KAAK,IAAI,KAAK,MAAMQ,EAAK,KAAG,CAAC,EAEpCP,EAAQ,KAAK,IAAI,KAAK,MAAOO,EAAK,MAAO,IAAI,CAAC,EAE9CN,EAAU,KAAK,IAAI,KAAK,MAAQM,EAAK,MAAO,KAAQ,GAAM,CAAC,EAE3DL,EAAU,KAAK,IAAI,KAAK,MAASK,EAAK,MAAO,KAAQ,IAAU,GAAM,CAAC,EAE5E,MAAO,CAAE,KAAAR,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACzC,CAED,IAAIM,EAAK,CACL,OAAO,OAAOA,CAAG,EAAE,SAAS,EAAE,GAAG,CACpC,CACL,CAEA,SAAS1B,EAAY2B,EAAO,CACpBhB,EAAkB,GACJ,IAAIU,EAAM,CAAE,OAAQL,EAAiB,UAAWX,EAAaX,EAAe,KAAK,CAAG,CAAA,EAC5F,MAAK,CAInB,CAIAkC,EAAUlC,EAAgBmB,CAAO"}